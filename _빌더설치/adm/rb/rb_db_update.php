<?php
/**
 * Obfuscated by Rebuilder
 * Website: https://rebuilder.co.kr
 */
goto WpzlW; WpzlW: $sub_menu = "\60\60\x30\x30\60\60"; goto gNtQx; MHktc: include_once "\56\x2e\x2f\x61\x64\x6d\151\x6e\x2e\x68\145\x61\x64\x2e\x70\150\160"; goto RsP3O; ThFSI: function upgrade_database($schema) { goto fA33O; fA33O: $is_upgrade = false; goto HAlnX; rINVs: return $is_upgrade ? "\x44\102\x20\354\x97\x85\xea\xb7\270\xeb\xa0\210\xec\235\264\353\223\234\352\xb0\x80\x20\354\231\204\353\243\x8c\353\220\x98\354\x97\210\354\212\xb5\xeb\x8b\x88\xeb\x8b\xa4\56" : "\353\215\x94\x20\354\x9d\264\xec\x83\201\40\354\227\x85\352\267\270\353\240\210\354\x9d\264\xeb\x93\234\40\xed\225\xa0\40\xeb\x82\xb4\354\232\xa9\354\x9d\xb4\x20\354\227\x86\xec\212\265\xeb\213\210\353\x8b\xa4\x2e\x3c\142\162\x3e\355\x98\x84\xec\x9e\xac\40\x44\x42\x20\354\227\205\352\267\270\353\xa0\210\xec\235\264\xeb\x93\x9c\xea\260\200\40\354\x99\204\353\243\214\353\x90\x9c\x20\xec\203\201\xed\203\234\354\x9e\x85\xeb\213\210\353\x8b\xa4\x2e"; goto SNi0L; HAlnX: foreach ($schema["\164\141\142\x6c\145\x73"] as $table => $info) { goto y9_M8; y9_M8: $columns = $info["\x63\157\x6c\165\x6d\156\163"]; goto sGSee; WHmXw: $result = sql_query("\x53\110\117\x57\x20\x54\101\102\x4c\x45\x53\x20\114\x49\113\105\x20\x27{$table}\47"); goto QSYS_; sGSee: $table = sql_real_escape_string($table); goto WHmXw; QSYS_: if (mysqli_num_rows($result) == 0) { goto VRfiX; Yt8XE: if (isset($info["\160\x72\x69\x6d\141\162\x79\137\153\x65\171"])) { $primary_key = sql_real_escape_string($info["\160\x72\x69\155\x61\x72\x79\137\x6b\145\171"]); $column_defs[] = "\120\x52\111\115\101\x52\x59\x20\113\x45\131\40\50\140{$primary_key}\x60\51"; } goto Kux_v; fdiR6: $create_result = sql_query($create); goto SDA07; Kux_v: $create = "\103\x52\105\x41\124\x45\40\124\101\102\x4c\x45\x20\x60{$table}\x60\x20\50" . implode("\x2c\40", $column_defs) . "\51"; goto fdiR6; gTea4: foreach ($columns as $col => $def) { goto Ok503; kVPEG: $column_defs[] = "\140{$col}\x60\x20{$def}"; goto xTTt1; Ok503: $col = sql_real_escape_string($col); goto n9aO4; n9aO4: $def = sql_real_escape_string($def); goto kVPEG; xTTt1: } goto Yt8XE; t0Po1: $is_upgrade = true; goto VXTX_; SDA07: if (!$create_result) { return "\x5b{$table}\135\40\xed\205\x8c\xec\235\xb4\xeb\270\224\x20\xec\x83\235\354\x84\xb1\x20\354\x8b\244\xed\214\250\72\40" . mysqli_error($GLOBALS["\147\65"]["\x63\x6f\156\x6e\x65\x63\x74\x5f\144\x62"]); } goto t0Po1; VRfiX: $column_defs = []; goto gTea4; VXTX_: } else { goto fowXW; I0IjG: if (!empty($add_columns)) { goto HQLxF; Jhgmx: $alter_result = sql_query($alter); goto Z1D9v; XQt8e: $is_upgrade = true; goto n1ye1; HQLxF: $alter = "\101\x4c\x54\105\x52\x20\x54\101\102\x4c\105\x20\140{$table}\140\40" . implode("\54\40", $add_columns); goto Jhgmx; Z1D9v: if (!$alter_result) { return "\x5b{$table}\135\x20\354\xbb\254\xeb\237\274\40\xec\266\x94\xea\xb0\x80\40\354\213\xa4\xed\x8c\xa8\x3a\x20" . mysqli_error($GLOBALS["\147\x35"]["\143\157\x6e\x6e\145\143\x74\x5f\x64\142"]); } goto XQt8e; n1ye1: } goto l8Ys9; Zw2y4: foreach ($columns as $col => $def) { goto uO4an; bdsMh: if ($col_exists === false) { return "\x5b{$table}\x5d\40\355\x85\x8c\xec\235\xb4\xeb\xb8\x94\354\235\230\x20\x5b{$col}\x5d\40\354\273\xac\353\237\274\40\xed\231\225\xec\x9d\xb8\x20\354\213\xa4\355\214\xa8\x3a\40" . mysqli_error($GLOBALS["\x67\x35"]["\143\157\156\156\x65\x63\164\137\144\x62"]); } goto FdH7j; ubz8n: $col_exists = sql_query("\x53\x48\117\x57\x20\103\x4f\x4c\x55\x4d\x4e\123\40\x46\122\x4f\x4d\x20\x60{$table}\x60\x20\x4c\111\x4b\105\x20\x27{$col}\x27"); goto bdsMh; FdH7j: if (mysqli_num_rows($col_exists) == 0) { $def = sql_real_escape_string($def); $add_columns[] = "\101\104\104\x20\x60{$col}\x60\x20{$def}"; } goto DuV3V; uO4an: $col = sql_real_escape_string($col); goto ubz8n; DuV3V: } goto I0IjG; fowXW: $add_columns = []; goto Zw2y4; l8Ys9: } goto ZKFzW; ZKFzW: } goto rINVs; SNi0L: } goto YoFK6; gAr92: function verify_license($key, $domain, $ip) { goto fuhqU; AUoVL: if (!filter_var($ip, FILTER_VALIDATE_IP)) { return "\354\236\230\353\xaa\273\353\220\x9c\40\x49\120\40\xec\xa3\xbc\xec\x86\x8c\x20\355\x98\225\354\x8b\x9d\xec\x9e\x85\xeb\213\x88\353\213\xa4\x3a\x20" . $ip; } goto jRtKY; fuhqU: if (!function_exists("\x63\x75\162\154\137\151\156\151\164")) { return "\x63\x55\x52\x4c\xec\235\x84\40\354\x82\254\354\x9a\251\xed\225\xa0\40\xec\210\230\x20\xec\227\206\xeb\x8a\224\x20\xec\x84\x9c\353\262\x84\40\354\x9e\205\xeb\213\210\353\x8b\244\56\x20\354\x84\234\xeb\262\204\355\232\x8c\354\202\xac\354\227\x90\x20\xeb\xac\270\354\235\230\xed\225\x98\354\204\xb8\354\232\224\56"; } goto AUoVL; Tp9W6: return $data; goto OSZa9; hSNQl: if ($response === false) { return "\354\227\x85\353\215\xb0\354\x9d\264\355\212\xb8\x20\xec\204\x9c\353\262\x84\xec\227\x90\40\xec\x9d\x91\xeb\x8b\xb5\xec\x9d\264\x20\354\227\x86\xec\x8a\xb5\353\x8b\x88\xeb\x8b\244\56"; } goto Vsj65; eqITy: $response = curl_exec($ch); goto rXj31; yWTdP: if (empty($data["\144\x61\x74\141"]["\163\143\x68\x65\x6d\x61"]["\x74\x61\x62\x6c\x65\163"])) { return "\355\205\214\354\235\xb4\353\xb8\224\40\xec\x8a\244\355\x82\244\353\xa7\210\40\xec\240\225\xeb\263\264\352\260\x80\40\354\227\206\xec\212\xb5\xeb\213\x88\353\213\244\x2e"; } goto Tp9W6; Vsj65: $data = json_decode($response, true); goto KE0OV; EUBbq: $post_data = ["\144\157\x6d\141\x69\156" => filter_var($domain, FILTER_SANITIZE_URL), "\x6b\x65\x79" => filter_var($key, FILTER_SANITIZE_STRING), "\x75\163\x65\162\137\x69\x70" => $ip]; goto yuR6f; h3ysV: if (!empty($data["\x73\x74\141\x74\x75\163"]) && $data["\163\x74\141\164\x75\163"] === "\x65\162\162\157\162") { return "\xec\227\x85\353\215\xb0\xec\x9d\264\xed\212\xb8\40\354\204\234\353\262\x84\40\354\235\221\353\213\xb5\72\40" . $data["\x64\x61\x74\x61"]; } goto yWTdP; XRLbh: curl_close($ch); goto hSNQl; KE0OV: if (json_last_error() !== JSON_ERROR_NONE || !isset($data["\163\164\141\164\165\163"])) { return "\354\x97\x85\353\215\260\xec\x9d\xb4\355\x8a\270\40\354\x84\234\xeb\xb2\x84\xec\x9d\x98\40\xec\235\x91\353\213\xb5\40\xed\x98\x95\354\213\x9d\354\x97\x90\x20\xeb\254\270\354\xa0\234\352\xb0\x80\40\xec\x9e\210\xec\212\xb5\353\x8b\x88\xeb\x8b\244\56"; } goto h3ysV; yuR6f: curl_setopt_array($ch, [CURLOPT_URL => $api_endpoint, CURLOPT_POST => true, CURLOPT_POSTFIELDS => http_build_query($post_data), CURLOPT_USERAGENT => "\115\x6f\172\x69\x6c\154\x61\57\65\x2e\60\x20\x2b\x72\x65\142\165\x69\x6c\x64\145\162\56\143\157\x2e\153\x72", CURLOPT_RETURNTRANSFER => true, CURLOPT_FOLLOWLOCATION => true, CURLOPT_SSL_VERIFYHOST => 0, CURLOPT_SSL_VERIFYPEER => 0, CURLOPT_TIMEOUT => 30]); goto eqITy; jRtKY: $ch = curl_init(); goto Q4KBI; rXj31: if (curl_errno($ch)) { goto VAN2x; dbNHk: return "\xec\227\205\xeb\215\xb0\354\x9d\xb4\355\212\xb8\40\xec\x84\234\xeb\262\204\40\xec\227\xb0\xea\xb2\xb0\x20\xec\x97\220\353\237\xac\x3a\x20" . $error_msg; goto LOSiy; FcJJm: curl_close($ch); goto dbNHk; VAN2x: $error_msg = curl_error($ch); goto FcJJm; LOSiy: } goto XRLbh; Q4KBI: $api_endpoint = "\150\164\x74\160\x73\72\x2f\x2f\162\145\x62\x75\151\x6c\144\x65\x72\55\x61\160\x69\56\143\x6f\155\57\x75\x70\x64\141\x74\145\57"; goto EUBbq; OSZa9: } goto ThFSI; mf_ck: function check_and_create_key_table() { $table_key = sql_query("\104\105\x53\103\x52\x49\102\105\40\x72\x62\137\153\x65\171", false); if (!$table_key) { goto mZG45; L5fvO: sql_query($sql_key); goto xo5N2; mZG45: sql_query("\103\x52\105\101\124\x45\x20\124\101\x42\114\x45\x20\x49\x46\40\116\117\124\x20\x45\130\x49\x53\x54\x53\40\140\x72\x62\x5f\x6b\x65\171\x60\40\50\15\12\x20\40\x20\40\x20\40\40\40\40\40\40\40\140\153\145\171\137\156\x6f\x60\40\166\x61\162\x63\x68\141\162\x28\x32\65\x35\x29\40\116\117\x54\x20\116\125\114\x4c\40\x44\105\x46\x41\x55\114\124\40\47\x27\54\xd\xa\x20\40\40\40\x20\x20\x20\40\40\40\x20\40\140\x6b\145\x79\x5f\144\x61\164\145\x74\x69\x6d\145\x60\x20\144\x61\164\x65\164\x69\155\145\40\116\117\124\x20\116\x55\114\114\40\x44\x45\106\101\x55\114\x54\x20\47\x30\60\x30\60\x2d\x30\60\55\x30\60\x20\x30\x30\72\x30\60\x3a\x30\60\47\xd\12\x20\40\x20\40\x20\40\x20\40\51\40\x45\x4e\x47\111\116\105\75\x4d\171\111\123\x41\x4d\x20\104\x45\106\101\125\x4c\x54\40\x43\110\101\122\123\105\124\75\165\164\146\x38", true); goto qYedM; HRp4Y: $in_key = sql_real_escape_string($in_key); goto UBEo5; qYedM: $in_key = get_random_token_string(24); goto HRp4Y; UBEo5: $sql_key = "\111\x4e\123\x45\x52\124\x20\x49\x4e\x54\x4f\40\x72\142\137\x6b\145\x79\40\15\12\x20\40\x20\x20\x20\40\40\40\40\40\x20\40\x20\x20\x20\x20\x20\x20\40\x20\123\x45\x54\x20\153\145\x79\x5f\x6e\x6f\40\x3d\x20\x27{$in_key}\47\x2c\15\xa\40\x20\40\x20\x20\x20\40\x20\x20\x20\40\x20\x20\x20\x20\40\x20\x20\x20\40\40\x20\x20\40\x6b\145\171\x5f\144\141\x74\145\164\x69\x6d\x65\x20\75\x20\47" . G5_TIME_YMDHIS . "\x27"; goto L5fvO; xo5N2: } } goto VZk3P; Hyl1Y: if ($is_admin != "\x73\x75\160\145\x72" && $w == '') { alert("\xec\265\234\352\xb3\240\352\xb4\200\353\xa6\xac\xec\x9e\x90\xeb\247\x8c\x20\354\xa0\x91\xea\267\xbc\x20\xea\260\200\xeb\x8a\xa5\xed\x95\251\353\213\x88\353\213\xa4\x2e"); } goto mf_ck; gNtQx: include_once "\56\57\x5f\x63\157\x6d\155\x6f\x6e\x2e\x70\x68\x70"; goto OXIeZ; OXIeZ: auth_check_menu($auth, $sub_menu, "\x77"); goto Hyl1Y; tXwVI: if (!is_array($key_info)) { $db_upgrade_msg = $key_info; } else { goto SCRfA; SCRfA: $in_key = $key_info["\153\x65\171\x5f\x6e\157"]; goto WbzCQ; WbzCQ: $key_cnt = $key_info["\x63\x6f\x75\156\164"]; goto ua3XX; ua3XX: if ($key_cnt < 1) { $db_upgrade_msg = "\xeb\235\xbc\354\235\xb4\354\204\240\354\212\244\355\202\xa4\353\xa5\274\40\xec\260\276\xec\235\204\40\354\210\x98\x20\xec\x97\x86\xec\212\265\xeb\213\x88\353\213\244\x2e"; } else { goto ecDNX; zXDhE: $response_data = verify_license($in_key, $site_domain, $user_ip); goto bgaDh; Cu995: $user_ip = get_real_client_ip(); goto zXDhE; ecDNX: $site_domain = $_SERVER["\110\124\124\120\x5f\x48\117\123\x54"]; goto Cu995; bgaDh: if (empty($response_data["\144\x61\164\x61"])) { $db_upgrade_msg = $response_data; } else { $schema = $response_data["\x64\141\164\x61"]["\x73\143\150\x65\x6d\x61"]; $db_upgrade_msg = upgrade_database($schema); } goto GUyh_; GUyh_: } goto oCwD5; oCwD5: } goto aiM7n; aiM7n: echo "\15\12\74\x64\x69\x76\40\x63\x6c\141\163\x73\x3d\42\x6c\157\143\x61\154\137\x64\x65\163\143\60\x31\40\154\x6f\x63\x61\x6c\x5f\144\x65\163\143\42\76\15\12\x20\x20\40\40\x3c\x70\x3e"; goto CjXTl; RsP3O: $key_info = get_license_key(); goto cC8ua; bBJZ2: echo "\74\57\160\76\15\xa\74\x2f\144\151\166\76\xd\12\15\xa"; goto bbZzS; VZk3P: function get_license_key() { goto KREtf; UulNW: return ["\x6b\x65\171\137\156\157" => $key_info["\153\x65\x79\x5f\x6e\x6f"], "\x63\157\x75\156\164" => $key_cnt]; goto zBlqN; QJSFN: $key_cnt = (int) sql_fetch("\x53\x45\114\x45\103\x54\40\103\x4f\125\116\124\x28\x2a\x29\x20\x61\163\40\143\156\x74\x20\x46\122\x4f\x4d\x20\162\142\137\153\145\171")["\x63\156\x74"] ?? 0; goto fbxrS; fbxrS: if ($key_cnt < 1) { return "\353\235\274\xec\x9d\264\354\204\240\xec\212\xa4\xed\x82\xa4\xeb\245\xbc\40\xec\xb0\xbe\354\235\x84\40\xec\x88\x98\x20\xec\227\206\xec\x8a\265\353\x8b\210\xeb\x8b\xa4\x2e"; } goto UulNW; QATr4: $key_info = sql_fetch("\x53\105\x4c\x45\103\124\x20\x6b\x65\x79\137\x6e\x6f\x20\x46\x52\117\115\x20\162\x62\137\x6b\x65\171\x20\x4c\x49\x4d\x49\x54\x20\x31"); goto QJSFN; KREtf: check_and_create_key_table(); goto QATr4; zBlqN: } goto gAr92; CjXTl: echo $db_upgrade_msg; goto bBJZ2; cC8ua: $db_upgrade_msg = ''; goto tXwVI; YoFK6: $g5["\x74\x69\164\x6c\145"] = "\104\102\40\354\227\x85\352\xb7\270\353\xa0\210\354\x9d\xb4\353\223\234"; goto MHktc; bbZzS: include_once "\x2e\56\x2f\x61\x64\x6d\x69\156\x2e\164\141\151\154\x2e\160\x68\160";
